# Проект: Система бронирования отелей

## Описание реализованной функциональности

Разработана система бронирования номеров в отелях.

### Сервисы

**Hotel Service**\
Отвечает за отели. Позволяет проводить стандартные CRUD операции с отелями.
Отвечает на gRPC запросы от BookingService для получения инфомрации об отеле.

**Booking Service**\
Отвечает за бронирования комнат в отелях. 
Поддерживает CRUD операции с бронированиями. Также предоставляет API для получения бронирований с фильтрацией по нескольким фильтрам на стороне бэкенда. 
Взаимодействует с HotelService и UserService через gRPC для подгрузки информации об отеле, в котором производится бронирование, и пользователе, который отправляет запрос, соответственно.
Отправляет сообщения через Kafka о необходимости отправки уведомления пользователю и создании нового бронирования. Эти сообщения позже обрабатываются NotificationService'ом.

**Notification Service**\
Отвечает за отправку уведомлений об оформлении бронирований.
Читает сообщения из Kafka и обрабатывает их.
Содержит интерфейс для отправки сообщений с помощью различных систем.
Написана конкретная реализация для отправки уведомлений через email.
(В силу отсутствия у нас конкретного email, с которого можно отправлять сообщения, проверка успеха отправки email замокана)

**User Service**\
Отвечает за информацию о пользователях.
Поддерживает CRUD операции над пользователями.
Поддерживает разделение пользователей на 2 роли: администраторы и клиенты.
Отвечает на gRPC запросы от BookingService для получения информации о клиентах.

## IPA (Inter-process communication)
**BookingService - UserService**
При создании бронирования BookingService обращается к UserService с помощью gRPC за информацией о клиенте. В частности, для получения его контактных данных и последующей отправки ему уведомления.

**BookingService - HotelService**
При получении бронирования BookingService обращается к HotelService с помощью gRPC за инфомрацией об отеле, в котором создается бронирования. Конкретно, стоимость комнаты за одну ночь.

**BookingService - NotificationService**
При создании бронирования BookingService отправляет сообщение в Kafka, получаемое затем в NotificationService, с запросом отправки клиенту уведомления об оформлении бронирования.

## Логгирование
Сервисы пишут структурированные логи в stdout, stderr с использованием slog.
Эта библиотека была рекомендована ментором на одном из созвонов, как позволяющая поддерживать различные уровни логгирования, время логов и т.д.

## Метрики
Сервисы пишут метрики в Prometheus. 
В частности, поддерживается информация о количестве поступивших запросов и времени их обработки.
Prometheus включен в docker-compose и поднимается вместе с приложением.

## Трассировка Jaeger
Сервисы обрабатывают данные трассировки и пишут их в Jaeger.
В частности, трассируется информация о запросах, поступивших в HotelService и BookingService.
Также трассируется информация о запросах, отправленных через Kafka от BookingService к NotificationService с целью отправки уведомления.
Jaeger включен в docker-compose и поднимается вместе с приложением.

## Покрытие тестами
В проекте написано юнит и интеграционные тесты, покрывающие проект более чем на 60%.
Из покрытия исключены сгенерированные файлы (например, для gRPC взаимодействия), моки для тестов.

## Интеграция с реальной системой доставки нотификации
Реализована интеграция с системой доставки нотификации через email.
Написаны общие интерфейсы отправки сообщений и оформления контента сообщения, чтобы можно было добавить дополнительные имплементации (например, sms или telegram) просто реализацией интерфейса.

## Дополнительные комментарии
Настраиваемые параметры вынесены в файл `.env`. 
При указании аттрибута GO_ENV="dev" используется файл `.env.dev`.

## Состав команды
Шаров Святослав. Фисман Максим. Фурманов Михаил.
